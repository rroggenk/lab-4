<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Global Health Monitor Dashboard</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="lab-4_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab-4_files/libs/quarto-html/quarto.js"></script>
<script src="lab-4_files/libs/quarto-html/popper.min.js"></script>
<script src="lab-4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab-4_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab-4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab-4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab-4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab-4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab-4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="lab-4_files/libs/quarto-dashboard/quarto-dashboard.js"></script>
<script src="lab-4_files/libs/quarto-dashboard/stickythead.js"></script>
<script src="lab-4_files/libs/quarto-dashboard/datatables.min.js" kdttablesentinel="true"></script>
<script src="lab-4_files/libs/quarto-dashboard/pdfmake.min.js" kdttablesentinel="true"></script>
<script src="lab-4_files/libs/quarto-dashboard/vfs_fonts.js" kdttablesentinel="true"></script>
<script src="lab-4_files/libs/quarto-dashboard/web-components.js" type="module"></script>
<script src="lab-4_files/libs/quarto-dashboard/components.js"></script>
<link href="lab-4_files/libs/quarto-dashboard/datatables.min.css" rel="stylesheet" kdttablesentinel="true">


</head>

<body class="quarto-dashboard dashboard-fill dashboard-sidebar fullcontent">

<header id="quarto-dashboard-header">
<nav class="navbar navbar-expand-md slim" data-bs-theme="dark">
  <div class="navbar-container container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-controls="dashboard-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>    


    <div class="navbar-brand-container">       
    <a href="#"><img src="images/Wellcome_Trust_logo.png" alt="" class="navbar-logo d-inline-block"></a>
      <div class="navbar-title">
        <div class="navbar-title-text"><a href="#">Global Health Monitor Dashboard</a></div>
        
        
      </div>
    </div>
<div id="dashboard-collapse" class="navbar-collapse collapse"><ul class="navbar-nav navbar-nav-scroll me-auto" role="tablist"><li class="nav-item" role="presentation"><a id="tab-vaccine-views" class="nav-link active" data-bs-toggle="tab" role="tab" data-bs-target="#vaccine-views" data-scrolling="false" href="#vaccine-views" aria-controls="vaccine-views" aria-selected="true"><span class="nav-link-text">Vaccine Views</span></a></li><li class="nav-item" role="presentation"><a id="tab-health-interest" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#health-interest" data-scrolling="false" href="#health-interest" aria-controls="health-interest" aria-selected="false"><span class="nav-link-text">Health Interest</span></a></li></ul><div class="quarto-dashboard-links"><a class="quarto-dashboard-link" href="https://github.com/rroggenk/" aria-label="GitHub"><i class="bi bi-github"></i></a><a class="quarto-dashboard-link" href="https://www.linkedin.com/in/rroggenk/" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a><a class="quarto-dashboard-link" href="mailto:rroggenk@calpoly.edu" aria-label="Email"><i class="bi bi-envelope"></i></a></div></div></div>
</nav>
</header>
<div class="page-layout-custom quarto-dashboard-content bslib-gap-spacing html-fill-container bslib-page-fill quarto-dashboard-pages">  

<div class="bslib-grid-item html-fill-item tab-content bslib-grid" data-layout="fill" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div id="vaccine-views" class="dashboard-page tab-pane show active html-fill-item html-fill-container dashboard-sidebar-container" data-orientation="columns" aria-labelledby="tab-vaccine-views">
<div class="bslib-sidebar-layout html-fill-item html-fill-container" data-bslib-sidebar-open="desktop" data-bslib-sidebar-init="true" data-bslib-sidebar-border="false" data-bslib-sidebar-border-radius="false"><div class="main html-fill-container html-fill-item"><div class="sidebar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 75fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 25fr) minmax(3em, 75fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 50fr) minmax(3em, 50fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card valuebox html-fill-item html-fill-container bslib-card bslib-value-box bg-info showcase-left-center" data-bslib-card-init="" data-require-bs-caller="card()">
<div class="card-body html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container value-box-grid">
<div class="value-box-showcase html-fill-item html-fill-container">

<i class="bi bi-shield-check"></i></div>
<div class="value-box-area">
<p class="value-box-title">
<span style="font-size: 0.8em;">Avg: Agree Safe (Selected Regions)</span>
</p>
<p class="value-box-value">
<div class="cell html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<span id="safe_avg_value" class="shiny-text-output"></span>
</div>
</div>
</p>
</div>
</div>
</div>
<script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card valuebox html-fill-item html-fill-container bslib-card bslib-value-box bg-danger showcase-left-center" data-bslib-card-init="" data-require-bs-caller="card()">
<div class="card-body html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container value-box-grid">
<div class="value-box-showcase html-fill-item html-fill-container">

<i class="bi bi-shield-x"></i></div>
<div class="value-box-area">
<p class="value-box-title">
&nbsp;
</p>
<p class="value-box-value">
<p>Global Avg: Disagree Effective 6.0%</p>
</p>
</div>
</div>
</div>
<script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card tabset html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header dashboard-card-no-title bslib-navs-card-title">

<ul class="nav nav-tabs card-header-tabs" role="tablist" data-tabsetid="card-tabset-3"><li class="nav-item" role="presentation"><a href="#card-tabset-3-1" role="tab" data-toggle="tab" data-bs-toggle="tab" data-value="Vaccine Safety Perception by Region" aria-selected="true" class="nav-link active">Vaccine Safety Perception by Region</a></li><li class="nav-item" role="presentation"><a href="#card-tabset-3-2" role="tab" data-toggle="tab" data-bs-toggle="tab" data-value="Safety vs. Effectiveness Disagreement" aria-selected="false" class="nav-link">Safety vs. Effectiveness Disagreement</a></li></ul></div>


<div class="tab-content html-fill-item html-fill-container" data-tabset-id="card-tabset-3"><div class="tab-pane active show html-fill-item html-fill-container" role="tabpanel" id="card-tabset-3-1"><div class="card-body html-fill-item html-fill-container" data-title="Vaccine Safety Perception by Region">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="vaccine_safety_plot" style="width:100%;height:400px;"></div>
</div>
</div></div><div class="tab-pane html-fill-item html-fill-container" role="tabpanel" id="card-tabset-3-2"><div class="card-body html-fill-item html-fill-container" data-title="Safety vs. Effectiveness Disagreement">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-fill-item html-fill-container" id="htmlwidget-7ec2ea2fd30b4f5a093d" style="width:100%;height:406px;"></div>
<script type="application/json" data-for="htmlwidget-7ec2ea2fd30b4f5a093d">{"x":{"data":[{"x":[0.045000000000000102,0.13,0.10000000000000001,0.045000000000000102,0.182,0.058823529411764698,0.186,0.098999999999999894,0.0079999999999999898,0.144203581526861,0.20119521912350599,0.121,0.114,0.072999999999999898,0.0379241516966069,0.087999999999999995,0.14385614385614401,0.18099999999999999,0.053999999999999999,0.047,0.14499999999999999,0.082015810276679896,0.084999999999999604,0.105,0.068237873389971004,0.092000000000000096,0.075999999999999707,0.049000000000000002,0.069999999999999896,0.056379821958456998,0.059999999999999998,0.085999999999999993,0.032000000000000001,0.053999999999999999,0.00300000000000002,0.106,0.11799999999999999,0.095000000000000001,0.029999999999999999,0.076999999999999999,0.309,0.26000000000000001,0.080000000000000002,0.13600000000000001,0.028000000000000001,0.040000000000000001,0.064000000000000001,0.129,0.16600000000000001,0.051999999999999998,0.024,0.20599999999999999,0.0186666666666668,0.040000000000000001,0.077611940298507404,0.039,0.076000000000000206,0.046534653465346597,0.13500000000000001,0.16700000000000001,0.076693227091633495,0.030938123752494901,0.10299999999999999,0.042999999999999997,0.052999999999999999,0.034965034965034898,0.078,0.010989010989011,0.16356513222331001,0.032000000000000001,0.021999999999999999,0.063808574277168503,0.063,0.129,0.118055555555556,0.090000000000000094,0.024999999999999901,0.018000000000000099,0.13300000000000001,0.062562065541211506,0.085999999999999896,0.159,0.062862669245647901,0.106,0.14099999999999999,0.124,0.031968031968032003,0.048999999999999898,0.035999999999999997,0.070646766169154093,0.034000000000000002,0.15984015984016001,0.090818363273453107,0.027,0.052999999999999999,0.050000000000000003,0.040999999999999898,0.055,0.036000000000000101,0.027,0.042999999999999899,0.062,0.16200000000000001,0.13300000000000001,0.052000000000000102,0.048951048951049098,0.14499999999999999,0.10379241516966101,0.2155,0.014999999999999999,0.040354330708661401,0.122,0.078,0.037999999999999902,0.024,0.048999999999999898,0.107,0.037000000000000102,0.060157790927021601,0.054000000000000097,0.062218214607754799,0.107,0.214,0.188,0.012,0.017000000000000001,0.021999999999999902,0.0420000000000001,0.20300000000000001,0.041958041958042203,0.058000000000000197,0.036999999999999901,0.072999999999999898,0.151,0.034825870646766198,0.078,0.099403578528827002,0.092999999999999999,0.032000000000000001,0.0340000000000001,0.039525691699604702,0.035000000000000003,0.068000000000000393,0.035999999999999997],"y":[0.019,0.070999999999999994,0.072999999999999704,0.032000000000000001,0.115,0.031904287138584203,0.098999999999999894,0.075999999999999804,0.0040000000000000001,0.093308199811498294,0.052788844621514099,0.063000000000000098,0.071999999999999995,0.053999999999999999,0.016966067864271499,0.063000000000000098,0.069930069930069894,0.076999999999999999,0.029000000000000099,0.016,0.085000000000000006,0.061264822134387303,0.064000000000000001,0.060999999999999999,0.0254864346396276,0.067000000000000004,0.024,0.043999999999999997,0.042999999999999899,0.033630069238377899,0.026000000000000099,0.0420000000000001,0.018000000000000099,0.060000000000000102,0.00500000000000004,0.072999999999999995,0.0580000000000001,0.0660000000000001,0.014999999999999999,0.041000000000000002,0.155,0.109,0.040000000000000001,0.035999999999999997,0.033000000000000002,0.024,0.056999999999999898,0.060999999999999999,0.073999999999999996,0.045999999999999999,0.014000000000000099,0.014,0.016999999999999901,0.081000000000000003,0.018905472636815902,0.031,0.032999999999999897,0.016831683168316802,0.049000000000000002,0.073999999999999996,0.0268924302788844,0.024950099800399202,0.053999999999999902,0.068000000000000296,0.050000000000000003,0.022977022977023,0.064999999999999905,0.0049950049950050002,0.095984329089128295,0.012,0.27100000000000002,0.041874376869391799,0.031,0.052999999999999999,0.072420634920634802,0.048000000000000001,0.016,0.028000000000000101,0.045000000000000102,0.046673286991062803,0.039,0.048000000000000001,0.050290135396518401,0.075999999999999804,0.0509999999999999,0.068000000000000199,0.039960039960039898,0.088999999999999801,0.021999999999999999,0.102487562189055,0.0589999999999999,0.10489510489510501,0.058882235528941999,0.034000000000000002,0.029000000000000001,0.13800000000000001,0.016,0.024999999999999901,0.036999999999999998,0.019,0.048000000000000001,0.065000000000000002,0.14000000000000001,0.092000000000000096,0.036999999999999998,0.082917082917082802,0.031,0.048902195608782402,0.1125,0.0069999999999999403,0.035433070866141801,0.081999999999999698,0.044000000000000102,0.0420000000000001,0.018999999999999899,0.02,0.070999999999999994,0.048000000000000001,0.0187376725838263,0.045999999999999999,0.0252479711451759,0.025000000000000001,0.086999999999999994,0.068000000000000102,0.00900000000000006,0.033000000000000002,0.0180000000000002,0.042000000000000003,0.084000000000000102,0.027972027972027701,0.029999999999999999,0.042000000000000197,0.108,0.074000000000000093,0.0288557213930348,0.025000000000000001,0.048707753479125301,0.065000000000000002,0.012,0.02,0.0138339920948617,0.036000000000000199,0.076999999999999999,0.017000000000000001],"text":["Country: Afghanistan<br>Disagree vaccines are safe: 4.5%<br>Disagree vaccines are effective: 1.9%","Country: Albania<br>Disagree vaccines are safe: 13%<br>Disagree vaccines are effective: 7.1%","Country: Algeria<br>Disagree vaccines are safe: 10%<br>Disagree vaccines are effective: 7.3%","Country: Argentina<br>Disagree vaccines are safe: 4.5%<br>Disagree vaccines are effective: 3.2%","Country: Armenia<br>Disagree vaccines are safe: 18.2%<br>Disagree vaccines are effective: 11.5%","Country: Australia<br>Disagree vaccines are safe: 5.88%<br>Disagree vaccines are effective: 3.19%","Country: Austria<br>Disagree vaccines are safe: 18.6%<br>Disagree vaccines are effective: 9.9%","Country: Azerbaijan<br>Disagree vaccines are safe: 9.9%<br>Disagree vaccines are effective: 7.6%","Country: Bangladesh<br>Disagree vaccines are safe: 0.8%<br>Disagree vaccines are effective: 0.4%","Country: Belarus<br>Disagree vaccines are safe: 14.42%<br>Disagree vaccines are effective: 9.33%","Country: Belgium<br>Disagree vaccines are safe: 20.12%<br>Disagree vaccines are effective: 5.28%","Country: Benin<br>Disagree vaccines are safe: 12.1%<br>Disagree vaccines are effective: 6.3%","Country: Bolivia<br>Disagree vaccines are safe: 11.4%<br>Disagree vaccines are effective: 7.2%","Country: Bosnia and Herzegovina<br>Disagree vaccines are safe: 7.3%<br>Disagree vaccines are effective: 5.4%","Country: Botswana<br>Disagree vaccines are safe: 3.79%<br>Disagree vaccines are effective: 1.7%","Country: Brazil<br>Disagree vaccines are safe: 8.8%<br>Disagree vaccines are effective: 6.3%","Country: Bulgaria<br>Disagree vaccines are safe: 14.39%<br>Disagree vaccines are effective: 6.99%","Country: Burkina Faso<br>Disagree vaccines are safe: 18.1%<br>Disagree vaccines are effective: 7.7%","Country: Burundi<br>Disagree vaccines are safe: 5.4%<br>Disagree vaccines are effective: 2.9%","Country: Cambodia<br>Disagree vaccines are safe: 4.7%<br>Disagree vaccines are effective: 1.6%","Country: Cameroon<br>Disagree vaccines are safe: 14.5%<br>Disagree vaccines are effective: 8.5%","Country: Canada<br>Disagree vaccines are safe: 8.2%<br>Disagree vaccines are effective: 6.13%","Country: Chad<br>Disagree vaccines are safe: 8.5%<br>Disagree vaccines are effective: 6.4%","Country: Chile<br>Disagree vaccines are safe: 10.5%<br>Disagree vaccines are effective: 6.1%","Country: China<br>Disagree vaccines are safe: 6.82%<br>Disagree vaccines are effective: 2.55%","Country: Colombia<br>Disagree vaccines are safe: 9.2%<br>Disagree vaccines are effective: 6.7%","Country: Comoros<br>Disagree vaccines are safe: 7.6%<br>Disagree vaccines are effective: 2.4%","Country: Costa Rica<br>Disagree vaccines are safe: 4.9%<br>Disagree vaccines are effective: 4.4%","Country: Croatia<br>Disagree vaccines are safe: 7%<br>Disagree vaccines are effective: 4.3%","Country: Cyprus<br>Disagree vaccines are safe: 5.64%<br>Disagree vaccines are effective: 3.36%","Country: Czech Republic<br>Disagree vaccines are safe: 6%<br>Disagree vaccines are effective: 2.6%","Country: Denmark<br>Disagree vaccines are safe: 8.6%<br>Disagree vaccines are effective: 4.2%","Country: Dominican Republic<br>Disagree vaccines are safe: 3.2%<br>Disagree vaccines are effective: 1.8%","Country: Ecuador<br>Disagree vaccines are safe: 5.4%<br>Disagree vaccines are effective: 6%","Country: Egypt<br>Disagree vaccines are safe: 0.3%<br>Disagree vaccines are effective: 0.5%","Country: El Salvador<br>Disagree vaccines are safe: 10.6%<br>Disagree vaccines are effective: 7.3%","Country: Estonia<br>Disagree vaccines are safe: 11.8%<br>Disagree vaccines are effective: 5.8%","Country: Eswatini<br>Disagree vaccines are safe: 9.5%<br>Disagree vaccines are effective: 6.6%","Country: Ethiopia<br>Disagree vaccines are safe: 3%<br>Disagree vaccines are effective: 1.5%","Country: Finland<br>Disagree vaccines are safe: 7.7%<br>Disagree vaccines are effective: 4.1%","Country: France<br>Disagree vaccines are safe: 30.9%<br>Disagree vaccines are effective: 15.5%","Country: Gabon<br>Disagree vaccines are safe: 26%<br>Disagree vaccines are effective: 10.9%","Country: Georgia<br>Disagree vaccines are safe: 8%<br>Disagree vaccines are effective: 4%","Country: Germany<br>Disagree vaccines are safe: 13.6%<br>Disagree vaccines are effective: 3.6%","Country: Ghana<br>Disagree vaccines are safe: 2.8%<br>Disagree vaccines are effective: 3.3%","Country: Greece<br>Disagree vaccines are safe: 4%<br>Disagree vaccines are effective: 2.4%","Country: Guatemala<br>Disagree vaccines are safe: 6.4%<br>Disagree vaccines are effective: 5.7%","Country: Guinea<br>Disagree vaccines are safe: 12.9%<br>Disagree vaccines are effective: 6.1%","Country: Haiti<br>Disagree vaccines are safe: 16.6%<br>Disagree vaccines are effective: 7.4%","Country: Honduras<br>Disagree vaccines are safe: 5.2%<br>Disagree vaccines are effective: 4.6%","Country: Hungary<br>Disagree vaccines are safe: 2.4%<br>Disagree vaccines are effective: 1.4%","Country: Iceland<br>Disagree vaccines are safe: 20.6%<br>Disagree vaccines are effective: 1.4%","Country: India<br>Disagree vaccines are safe: 1.87%<br>Disagree vaccines are effective: 1.7%","Country: Indonesia<br>Disagree vaccines are safe: 4%<br>Disagree vaccines are effective: 8.1%","Country: Iran<br>Disagree vaccines are safe: 7.76%<br>Disagree vaccines are effective: 1.89%","Country: Iraq<br>Disagree vaccines are safe: 3.9%<br>Disagree vaccines are effective: 3.1%","Country: Ireland<br>Disagree vaccines are safe: 7.6%<br>Disagree vaccines are effective: 3.3%","Country: Israel<br>Disagree vaccines are safe: 4.65%<br>Disagree vaccines are effective: 1.68%","Country: Italy<br>Disagree vaccines are safe: 13.5%<br>Disagree vaccines are effective: 4.9%","Country: Ivory Coast<br>Disagree vaccines are safe: 16.7%<br>Disagree vaccines are effective: 7.4%","Country: Japan<br>Disagree vaccines are safe: 7.67%<br>Disagree vaccines are effective: 2.69%","Country: Jordan<br>Disagree vaccines are safe: 3.09%<br>Disagree vaccines are effective: 2.5%","Country: Kazakhstan<br>Disagree vaccines are safe: 10.3%<br>Disagree vaccines are effective: 5.4%","Country: Kenya<br>Disagree vaccines are safe: 4.3%<br>Disagree vaccines are effective: 6.8%","Country: Kosovo<br>Disagree vaccines are safe: 5.3%<br>Disagree vaccines are effective: 5%","Country: Kuwait<br>Disagree vaccines are safe: 3.5%<br>Disagree vaccines are effective: 2.3%","Country: Kyrgyzstan<br>Disagree vaccines are safe: 7.8%<br>Disagree vaccines are effective: 6.5%","Country: Laos<br>Disagree vaccines are safe: 1.1%<br>Disagree vaccines are effective: 0.5%","Country: Latvia<br>Disagree vaccines are safe: 16.36%<br>Disagree vaccines are effective: 9.6%","Country: Lebanon<br>Disagree vaccines are safe: 3.2%<br>Disagree vaccines are effective: 1.2%","Country: Liberia<br>Disagree vaccines are safe: 2.2%<br>Disagree vaccines are effective: 27.1%","Country: Libya<br>Disagree vaccines are safe: 6.38%<br>Disagree vaccines are effective: 4.19%","Country: Lithuania<br>Disagree vaccines are safe: 6.3%<br>Disagree vaccines are effective: 3.1%","Country: Luxembourg<br>Disagree vaccines are safe: 12.9%<br>Disagree vaccines are effective: 5.3%","Country: Macedonia<br>Disagree vaccines are safe: 11.81%<br>Disagree vaccines are effective: 7.24%","Country: Madagascar<br>Disagree vaccines are safe: 9%<br>Disagree vaccines are effective: 4.8%","Country: Malawi<br>Disagree vaccines are safe: 2.5%<br>Disagree vaccines are effective: 1.6%","Country: Malaysia<br>Disagree vaccines are safe: 1.8%<br>Disagree vaccines are effective: 2.8%","Country: Mali<br>Disagree vaccines are safe: 13.3%<br>Disagree vaccines are effective: 4.5%","Country: Malta<br>Disagree vaccines are safe: 6.26%<br>Disagree vaccines are effective: 4.67%","Country: Mauritania<br>Disagree vaccines are safe: 8.6%<br>Disagree vaccines are effective: 3.9%","Country: Mauritius<br>Disagree vaccines are safe: 15.9%<br>Disagree vaccines are effective: 4.8%","Country: Mexico<br>Disagree vaccines are safe: 6.29%<br>Disagree vaccines are effective: 5.03%","Country: Moldova<br>Disagree vaccines are safe: 10.6%<br>Disagree vaccines are effective: 7.6%","Country: Mongolia<br>Disagree vaccines are safe: 14.1%<br>Disagree vaccines are effective: 5.1%","Country: Montenegro<br>Disagree vaccines are safe: 12.4%<br>Disagree vaccines are effective: 6.8%","Country: Morocco<br>Disagree vaccines are safe: 3.2%<br>Disagree vaccines are effective: 4%","Country: Mozambique<br>Disagree vaccines are safe: 4.9%<br>Disagree vaccines are effective: 8.9%","Country: Myanmar<br>Disagree vaccines are safe: 3.6%<br>Disagree vaccines are effective: 2.2%","Country: Namibia<br>Disagree vaccines are safe: 7.06%<br>Disagree vaccines are effective: 10.25%","Country: Nepal<br>Disagree vaccines are safe: 3.4%<br>Disagree vaccines are effective: 5.9%","Country: Netherlands<br>Disagree vaccines are safe: 15.98%<br>Disagree vaccines are effective: 10.49%","Country: New Zealand<br>Disagree vaccines are safe: 9.08%<br>Disagree vaccines are effective: 5.89%","Country: Nicaragua<br>Disagree vaccines are safe: 2.7%<br>Disagree vaccines are effective: 3.4%","Country: Niger<br>Disagree vaccines are safe: 5.3%<br>Disagree vaccines are effective: 2.9%","Country: Nigeria<br>Disagree vaccines are safe: 5%<br>Disagree vaccines are effective: 13.8%","Country: Northern Cyprus<br>Disagree vaccines are safe: 4.1%<br>Disagree vaccines are effective: 1.6%","Country: Norway<br>Disagree vaccines are safe: 5.5%<br>Disagree vaccines are effective: 2.5%","Country: Pakistan<br>Disagree vaccines are safe: 3.6%<br>Disagree vaccines are effective: 3.7%","Country: Palestinian Territories<br>Disagree vaccines are safe: 2.7%<br>Disagree vaccines are effective: 1.9%","Country: Panama<br>Disagree vaccines are safe: 4.3%<br>Disagree vaccines are effective: 4.8%","Country: Paraguay<br>Disagree vaccines are safe: 6.2%<br>Disagree vaccines are effective: 6.5%","Country: Peru<br>Disagree vaccines are safe: 16.2%<br>Disagree vaccines are effective: 14%","Country: Philippines<br>Disagree vaccines are safe: 13.3%<br>Disagree vaccines are effective: 9.2%","Country: Poland<br>Disagree vaccines are safe: 5.2%<br>Disagree vaccines are effective: 3.7%","Country: Portugal<br>Disagree vaccines are safe: 4.9%<br>Disagree vaccines are effective: 8.29%","Country: Republic of Congo<br>Disagree vaccines are safe: 14.5%<br>Disagree vaccines are effective: 3.1%","Country: Romania<br>Disagree vaccines are safe: 10.38%<br>Disagree vaccines are effective: 4.89%","Country: Russia<br>Disagree vaccines are safe: 21.55%<br>Disagree vaccines are effective: 11.25%","Country: Rwanda<br>Disagree vaccines are safe: 1.5%<br>Disagree vaccines are effective: 0.7%","Country: Saudi Arabia<br>Disagree vaccines are safe: 4.04%<br>Disagree vaccines are effective: 3.54%","Country: Senegal<br>Disagree vaccines are safe: 12.2%<br>Disagree vaccines are effective: 8.2%","Country: Serbia<br>Disagree vaccines are safe: 7.8%<br>Disagree vaccines are effective: 4.4%","Country: Sierra Leone<br>Disagree vaccines are safe: 3.8%<br>Disagree vaccines are effective: 4.2%","Country: Singapore<br>Disagree vaccines are safe: 2.4%<br>Disagree vaccines are effective: 1.9%","Country: Slovakia<br>Disagree vaccines are safe: 4.9%<br>Disagree vaccines are effective: 2%","Country: Slovenia<br>Disagree vaccines are safe: 10.7%<br>Disagree vaccines are effective: 7.1%","Country: South Africa<br>Disagree vaccines are safe: 3.7%<br>Disagree vaccines are effective: 4.8%","Country: South Korea<br>Disagree vaccines are safe: 6.02%<br>Disagree vaccines are effective: 1.87%","Country: Spain<br>Disagree vaccines are safe: 5.4%<br>Disagree vaccines are effective: 4.6%","Country: Sri Lanka<br>Disagree vaccines are safe: 6.22%<br>Disagree vaccines are effective: 2.52%","Country: Sweden<br>Disagree vaccines are safe: 10.7%<br>Disagree vaccines are effective: 2.5%","Country: Switzerland<br>Disagree vaccines are safe: 21.4%<br>Disagree vaccines are effective: 8.7%","Country: Taiwan<br>Disagree vaccines are safe: 18.8%<br>Disagree vaccines are effective: 6.8%","Country: Tajikistan<br>Disagree vaccines are safe: 1.2%<br>Disagree vaccines are effective: 0.9%","Country: Tanzania<br>Disagree vaccines are safe: 1.7%<br>Disagree vaccines are effective: 3.3%","Country: Thailand<br>Disagree vaccines are safe: 2.2%<br>Disagree vaccines are effective: 1.8%","Country: The Gambia<br>Disagree vaccines are safe: 4.2%<br>Disagree vaccines are effective: 4.2%","Country: Togo<br>Disagree vaccines are safe: 20.3%<br>Disagree vaccines are effective: 8.4%","Country: Tunisia<br>Disagree vaccines are safe: 4.2%<br>Disagree vaccines are effective: 2.8%","Country: Turkey<br>Disagree vaccines are safe: 5.8%<br>Disagree vaccines are effective: 3%","Country: Turkmenistan<br>Disagree vaccines are safe: 3.7%<br>Disagree vaccines are effective: 4.2%","Country: Uganda<br>Disagree vaccines are safe: 7.3%<br>Disagree vaccines are effective: 10.8%","Country: Ukraine<br>Disagree vaccines are safe: 15.1%<br>Disagree vaccines are effective: 7.4%","Country: United Arab Emirates<br>Disagree vaccines are safe: 3.48%<br>Disagree vaccines are effective: 2.89%","Country: United Kingdom<br>Disagree vaccines are safe: 7.8%<br>Disagree vaccines are effective: 2.5%","Country: United States<br>Disagree vaccines are safe: 9.94%<br>Disagree vaccines are effective: 4.87%","Country: Uruguay<br>Disagree vaccines are safe: 9.3%<br>Disagree vaccines are effective: 6.5%","Country: Uzbekistan<br>Disagree vaccines are safe: 3.2%<br>Disagree vaccines are effective: 1.2%","Country: Venezuela<br>Disagree vaccines are safe: 3.4%<br>Disagree vaccines are effective: 2%","Country: Vietnam<br>Disagree vaccines are safe: 3.95%<br>Disagree vaccines are effective: 1.38%","Country: Yemen<br>Disagree vaccines are safe: 3.5%<br>Disagree vaccines are effective: 3.6%","Country: Zambia<br>Disagree vaccines are safe: 6.8%<br>Disagree vaccines are effective: 7.7%","Country: Zimbabwe<br>Disagree vaccines are safe: 3.6%<br>Disagree vaccines are effective: 1.7%"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(135,206,255,1)","opacity":1,"size":6.8031496062992138,"symbol":"square","line":{"width":1.8897637795275593,"color":"rgba(135,206,255,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.00300000000000002,0.0068734177215190075,0.010746835443037995,0.014620253164556982,0.01849367088607597,0.022367088607594957,0.026240506329113945,0.030113924050632932,0.033987341772151916,0.037860759493670904,0.041734177215189891,0.045607594936708878,0.049481012658227866,0.053354430379746853,0.057227848101265841,0.061101265822784828,0.064974683544303816,0.068848101265822803,0.072721518987341791,0.076594936708860778,0.080468354430379765,0.084341772151898753,0.08821518987341774,0.092088607594936728,0.095962025316455715,0.099835443037974703,0.10370886075949369,0.10758227848101268,0.11145569620253166,0.11532911392405065,0.11920253164556964,0.12307594936708863,0.12694936708860763,0.13082278481012663,0.1346962025316456,0.13856962025316458,0.14244303797468358,0.14631645569620258,0.15018987341772155,0.15406329113924053,0.15793670886075953,0.16181012658227853,0.1656835443037975,0.16955696202531648,0.17343037974683548,0.17730379746835448,0.18117721518987345,0.18505063291139243,0.18892405063291143,0.19279746835443043,0.1966708860759494,0.20054430379746838,0.20441772151898738,0.20829113924050638,0.21216455696202535,0.21603797468354433,0.21991139240506333,0.22378481012658233,0.2276582278481013,0.23153164556962028,0.23540506329113928,0.23927848101265828,0.24315189873417725,0.24702531645569623,0.2508987341772152,0.2547721518987342,0.2586455696202532,0.26251898734177215,0.26639240506329115,0.27026582278481015,0.2741392405063291,0.2780126582278481,0.2818860759493671,0.2857594936708861,0.2896329113924051,0.29350632911392405,0.29737974683544305,0.30125316455696205,0.305126582278481,0.309],"y":[0.024835524046372827,0.026109448810911241,0.027383373575449652,0.028657298339988063,0.029931223104526478,0.031205147869064889,0.032479072633603299,0.033752997398141714,0.035026922162680128,0.036300846927218536,0.03757477169175695,0.038848696456295365,0.040122621220833772,0.041396545985372186,0.042670470749910601,0.043944395514449008,0.045218320278987423,0.046492245043525837,0.047766169808064252,0.049040094572602659,0.050314019337141073,0.051587944101679488,0.052861868866217895,0.05413579363075631,0.055409718395294724,0.056683643159833132,0.057957567924371546,0.05923149268890996,0.060505417453448375,0.061779342217986782,0.063053266982525197,0.064327191747063611,0.065601116511602026,0.06687504127614044,0.068148966040678854,0.069422890805217255,0.070696815569755669,0.071970740334294098,0.073244665098832498,0.074518589863370913,0.075792514627909327,0.077066439392447741,0.078340364156986156,0.079614288921524556,0.080888213686062971,0.082162138450601385,0.0834360632151398,0.0847099879796782,0.085983912744216628,0.087257837508755043,0.088531762273293443,0.089805687037831858,0.091079611802370272,0.092353536566908687,0.093627461331447101,0.094901386095985502,0.096175310860523916,0.097449235625062344,0.098723160389600745,0.099997085154139159,0.10127100991867757,0.10254493468321599,0.1038188594477544,0.1050927842122928,0.10636670897683122,0.10764063374136963,0.10891455850590805,0.11018848327044645,0.11146240803498486,0.11273633279952328,0.11401025756406168,0.11528418232860009,0.1165581070931385,0.11783203185767693,0.11910595662221535,0.12037988138675375,0.12165380615129216,0.12292773091583058,0.12420165568036898,0.12547558044490739],"text":"","type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.0236220472440949,"color":"rgba(238,238,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":150,"r":7.3059360730593621,"b":27.031963470319642,"l":28.493150684931514},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.012299999999999981,0.32429999999999998],"tickmode":"array","ticktext":["0%","10%","20%","30%"],"tickvals":[0,0.099999999999999992,0.20000000000000001,0.30000000000000004],"categoryorder":"array","categoryarray":["0%","10%","20%","30%"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0093500000000000007,0.28434999999999999],"tickmode":"array","ticktext":["0%","10%","20%"],"tickvals":[0,0.10000000000000001,0.20000000000000001],"categoryorder":"array","categoryarray":["0%","10%","20%"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative","title":{"text":"Scatterplot exploring people's perceptions of vaccine safety <br> and vaccine effectiveness<br><sup>Percentage of people who disagree that vaccines are safe by percentage of people who <br> disagree that vaccines are effective<\/sup>","x":0.01,"xanchor":"left"}},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"582f21cdcd96":{"x":{},"y":{},"text":{},"type":"scatter"},"582f4e744430":{"x":{},"y":{}}},"cur_data":"582f21cdcd96","visdat":{"582f21cdcd96":["function (y) ","x"],"582f4e744430":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div></div></div><bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div></div><aside id="bslib-sidebar-1" class="sidebar html-fill-container html-fill-item"><div class="html-fill-item html-fill-container">
<div class="cell-output-display">
<div id="selected_regions" class="form-group shiny-input-checkboxgroup shiny-input-container" role="group" aria-labelledby="selected_regions-label">
<label class="control-label" id="selected_regions-label" for="selected_regions">Select Regions to Display:</label>
<div class="shiny-options-group">
<div class="checkbox">
<label>
<input type="checkbox" name="selected_regions" value="Africa" checked="checked">
<span>Africa</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="selected_regions" value="Americas" checked="checked">
<span>Americas</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="selected_regions" value="Asia &amp; Oceania" checked="checked">
<span>Asia &amp; Oceania</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="selected_regions" value="Europe" checked="checked">
<span>Europe</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="selected_regions" value="Former Soviet Union" checked="checked">
<span>Former Soviet Union</span>
</label>
</div>
<div class="checkbox">
<label>
<input type="checkbox" name="selected_regions" value="Middle East &amp; North Africa" checked="checked">
<span>Middle East &amp; North Africa</span>
</label>
</div>
</div>
</div>
</div>
</div></aside>
<button class="collapse-toggle" type="button" title="Toggle sidebar" aria-expanded="true" aria-controls="bslib-sidebar-1">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16" class="bi bi-chevron-left collapse-icon" style="fill:currentColor;" aria-hidden="true" role="img">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
    </svg>
</button>
<script data-bslib-sidebar-init="">
bslib.Sidebar.initCollapsibleAll()
</script>
</div>
</div><div id="health-interest" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container dashboard-sidebar-container" data-orientation="columns" aria-labelledby="tab-health-interest">
<div class="bslib-sidebar-layout html-fill-item html-fill-container" data-bslib-sidebar-open="desktop" data-bslib-sidebar-init="true"><div class="main html-fill-container html-fill-item"><div class="sidebar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 75fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-title="Countries by Interest in Health Information" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container">Countries by Interest in Health Information</div></div>
<div class="cell card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="datatables html-widget html-widget-output shiny-report-size html-fill-item html-fill-container" id="health_table" style="width:100%;height:auto;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<div id="3ade8a4a-fb1d-4a6c-8409-ac45482d5fc9" class="hidden html-fill-item html-fill-container">

</div>
</div>
</div>
</div></div><aside id="bslib-sidebar-2" class="sidebar html-fill-container html-fill-item"><div class="html-fill-item html-fill-container">
<div class="cell-output-display">
<div class="form-group shiny-input-container no-baseline">
<label class="control-label" id="interest_threshold-label" for="interest_threshold">Minimum % Interested in Health Info:</label>
<input class="js-range-slider" id="interest_threshold" data-skin="shiny" data-min="22" data-max="76" data-from="49" data-step="1" data-grid="true" data-grid-num="9" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-postfix="%" data-keyboard="true" data-data-type="number">
</div>
</div>
</div></aside>
<button class="collapse-toggle" type="button" title="Toggle sidebar" aria-expanded="true" aria-controls="bslib-sidebar-2">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16" class="bi bi-chevron-left collapse-icon" style="fill:currentColor;" aria-hidden="true" role="img">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
    </svg>
</button>
<script data-bslib-sidebar-init="">
bslib.Sidebar.initCollapsibleAll()
</script>
</div>
</div>
</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
# Load Libraries
library(shiny) # <<< Shiny library
library(tidyverse)
# library(readxl) # Not used in this version
library(here) # Good practice, but using absolute paths from user for now
library(scales)
library(plotly)
# library(leaflet) # Not used
# library(maps) # Not used
# library(sf) # Not used
# library(geojsonio) # Not used
library(DT) 
# library(ggrepel) # Not used in the final plots shown

# --- Data Loading and Prep Code ---
# Consider using here::here("data", "vaccine_data_card.csv") if files are in a 'data' subfolder
# Using absolute paths provided by user for now.

# Data for Cards - Load full data needed for dynamic card calc
# vaccine_data_card <- read.csv("/Users/rachelroggenkemper/Documents/STAT541/Labs/Lab4/data/vaccine_data_card.csv") # Original - might not be needed if vaccine_data contains same info
vaccine_plot_data_card <- read.csv("/Users/rachelroggenkemper/Documents/STAT541/Labs/Lab4/data/vaccine_plot_data_card.csv")

# Data for Plot 1 (also used for dynamic card)
vaccine_data <- read.csv("/Users/rachelroggenkemper/Documents/STAT541/Labs/Lab4/data/vaccine_data.csv")

# Data for Plot 2
vaccine_plot_data <- read.csv("/Users/rachelroggenkemper/Documents/STAT541/Labs/Lab4/data/vaccine_plot_data.csv")

# Data for Plot 3 (Interactive Table)
health_data <- read.csv("/Users/rachelroggenkemper/Documents/STAT541/Labs/Lab4/data/health_data.csv")

# Initial calculation for the second (static) card
global_avg_disagree_effective <- mean(vaccine_plot_data_card$disagree_effective_pct, na.rm = TRUE)

# Get unique regions for checkbox input
unique_regions <- unique(vaccine_data$global_region)
# Ensure regions are sorted or in a desired order if necessary
unique_regions <- sort(unique_regions) 

</script>
 
<script type="application/shiny-prerendered" data-context="server">
# Server logic to calculate and render the dynamic value for Card 1

# Reactive calculation for the average 'vaccine_safe' based on selected regions
filtered_safe_avg <- reactive({
  req(input$selected_regions) # Ensure regions are selected
  
  # Filter vaccine_data based on selected regions
  filtered_data <- vaccine_data %>%
    filter(global_region %in% input$selected_regions)
  
  # Handle case where no data remains after filtering (though req() should prevent this)
  if (nrow(filtered_data) == 0) {
    return("N/A") 
  }
  
  # Calculate the mean for the filtered data
  mean_val <- mean(filtered_data$vaccine_safe, na.rm = TRUE)
  
  # Format as percentage string
  scales::percent(mean_val, accuracy = 0.1)
})

# Render the calculated value into the textOutput placeholder
output$safe_avg_value <- renderText({
  filtered_safe_avg()
})

</script>
 
<script type="application/shiny-prerendered" data-context="server">
# Server logic to render the dynamic plot

output$vaccine_safety_plot <- renderPlot({
  req(input$selected_regions) # Ensure regions are selected
  
  # Filter data based on selected regions
  plot_data_filtered <- vaccine_data %>%
    filter(global_region %in% input$selected_regions)
  
  # Check if any data remains after filtering
  if (nrow(plot_data_filtered) == 0) {
    # Display a message if no regions are selected or no data exists
    plot(NULL, xlim=c(0,1), ylim=c(0,1), ann=FALSE, axes=FALSE)
    text(0.5, 0.5, "Please select at least one region.")
    return() # Stop execution if no data
  }

  # Generate the plot with filtered data
  # Using a named color vector for robustness if regions are filtered out
  region_colors <- setNames(
      c("skyblue1", "seagreen4", "yellow2", "orangered4", "salmon1", "dodgerblue4"),
      sort(unique(vaccine_data$global_region)) # Match colors to sorted region names
  )
  
  # Filter the colors to only those selected
  plot_colors <- region_colors[names(region_colors) %in% input$selected_regions]

  # Determine factor levels based on the full dataset's median for consistent ordering
  ordered_levels <- levels(reorder(vaccine_data$global_region, vaccine_data$region_median))
  # Filter levels to only those selected
  plot_levels <- ordered_levels[ordered_levels %in% input$selected_regions]
  
  plot_data_filtered %>%
    # Apply the filtered factor levels
    mutate(global_region = factor(global_region, levels = plot_levels)) %>%
    ggplot(aes(y = global_region, 
               x = vaccine_safe, 
               color = global_region)) +
    geom_point(aes(alpha = 0.78), size = 3, show.legend = FALSE) + # Use fixed size/alpha
    geom_errorbar(aes(y = global_region, 
                      xmax = region_median, 
                      xmin = region_median),
                  size = 0.5, 
                  linetype = "solid", 
                  width = 0.5, # Reduced width for potentially fewer regions
                  color = "black") +
    scale_color_manual(values = plot_colors) + # Use filtered colors
    labs(x = NULL, 
         y = NULL,
         title = "Percentage of People who Believe Vaccines are Safe,\nby Country and Selected Global Region(s)") + 
    theme_bw() +
    theme(legend.position = "none",
          panel.grid.major.y = element_blank(),
          panel.grid.minor.y = element_blank(),
          axis.ticks.y = element_blank(),
          axis.text.y = element_blank(), # Keep blank as labels are added via geom_text
          plot.title = element_text(face = 'bold')) +
    scale_x_continuous(breaks = seq(0.2, 1, by = 0.1),
                       labels = label_percent(),
                       limits = c(0.15, 1.05), # Adjust limits slightly for text
                       oob = scales::rescale_none) + # Show points outside limits if any
    guides(color = "none") + # Use "none" instead of FALSE
    # Add region labels 
    geom_text(aes(y = global_region, x = 0.18, label = global_region), # Adjusted x position
              hjust = 0,
              size = 4,
              fontface = "bold",
              check_overlap = FALSE, # Allow overlap if needed, or adjust plot height
              show.legend = FALSE) + 
    # Add min/max labels (ensure 'min_max' column exists in filtered data)
    geom_text(data = . %>% filter(!is.na(min_max)), # Only plot where min_max exists
              aes(label = min_max), 
              vjust = -0.5, # Adjust vertical position relative to point
              hjust = 0.5, # Center horizontally on point
              size = 3, 
              color = "gray18",
              check_overlap = TRUE,
              show.legend = FALSE) +
    coord_cartesian(clip = "off") # Allow text outside plot area if needed

}, res = 96) # Set resolution for better plot rendering

</script>
 
<script type="application/shiny-prerendered" data-context="server">
# Server logic to render the dynamic DT table

output$health_table <- renderDT({
  req(input$interest_threshold) # Ensure slider value is available
  
  # Filter health data based on slider input
  filtered_health_data <- health_data %>%
    filter(percentage >= input$interest_threshold) %>%
    # Select and rename columns for clarity in the table
    select(Country = country, `Interest Percentage` = percentage) %>%
    # Arrange by percentage, descending
    arrange(`Interest Percentage`)
  
  # Create the datatable
  datatable(filtered_health_data,
            rownames = FALSE, # Don't show row numbers
            options = list(
              pageLength = 10, # Show 10 rows per page
              autoWidth = TRUE,
              # Ensure sorting works correctly on the numeric column before formatting
              order = list(list(1, 'asc')), # Sort by the second column (index 1) ascending
              columnDefs = list(
                  list(className = 'dt-center', targets = "_all") # Center align text
              ) 
            )) %>%
    # Use formatRound instead of formatPercentage
    formatRound('Interest Percentage', digits = 1) 

})
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.10.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.10.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["typedarray"]},{"type":"character","attributes":{},"value":["0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/typedarray"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["typedarray.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.10.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.5.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.2.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"character","attributes":{},"value":["1.2.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/crosstalk.min.js"]},{"type":"character","attributes":{},"value":["css/crosstalk.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.2.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-htmlwidgets-css"]},{"type":"character","attributes":{},"value":["2.11.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/plotlyjs"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly-htmlwidgets.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.10.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-main"]},{"type":"character","attributes":{},"value":["2.11.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/plotlyjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly-latest.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.10.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["datatables-css"]},{"type":"character","attributes":{},"value":["0.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/css"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["datatables-crosstalk.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["DT"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.33"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["datatables-binding"]},{"type":"character","attributes":{},"value":["0.33"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["datatables.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["DT"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.33"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.5.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.2.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"character","attributes":{},"value":["1.2.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/crosstalk.min.js"]},{"type":"character","attributes":{},"value":["css/crosstalk.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.2.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79]}},"value":[{"type":"character","attributes":{},"value":["base","bslib","cachem","cli","colorspace","compiler","crosstalk","data.table","datasets","digest","dplyr","DT","evaluate","fansi","fastmap","forcats","generics","ggplot2","glue","graphics","grDevices","grid","gtable","here","hms","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","knitr","later","lattice","lazyeval","lifecycle","lubridate","magrittr","Matrix","memoise","methods","mgcv","mime","munsell","nlme","pillar","pkgconfig","plotly","promises","purrr","R6","Rcpp","readr","rlang","rmarkdown","rprojroot","rstudioapi","sass","scales","shiny","splines","stats","stringi","stringr","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","utf8","utils","vctrs","viridisLite","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["4.4.3","0.8.0","1.1.0","3.6.3","2.1-1","4.4.3","1.2.1","1.17.0","4.4.3","0.6.37","1.1.4","0.33","1.0.0","1.0.6","1.2.0","1.0.0","0.1.3","3.5.1","1.8.0","4.4.3","4.4.3","4.4.3","0.3.5","1.0.1","1.1.3","0.5.8.1","1.6.4","1.6.15","1.4.7","0.1.4","1.8.9","1.48","1.3.2","0.22-6","0.2.2","1.0.4","1.9.4","2.0.3","1.7-2","2.0.1","4.4.3","1.9-1","0.12","0.5.1","3.1-167","1.9.0","2.0.3","4.10.4","1.3.2","1.0.2","2.5.1","1.0.13","2.1.5","1.1.4","2.28","2.0.4","0.16.0","0.4.9","1.3.0","1.10.0","4.4.3","4.4.3","1.8.4","1.5.1","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","4.4.3","0.4.0","1.2.4","4.4.3","0.6.5","0.4.2","3.0.1","0.52","1.8-4","2.3.10"]}]}]}
</script>
<!--/html_preserve-->


<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /container fluid -->

<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (_event) {
  if (window.bslib.Card) {
    window.bslib.Card.initializeAllCards();
  }
}); 
</script>
  



</body></html>